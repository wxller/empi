{"remainingRequest":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/babel-loader/lib/index.js!/Users/wuxingliu/ylz_work/2020/statistics/node_modules/eslint-loader/index.js??ref--13-0!/Users/wuxingliu/ylz_work/2020/statistics/src/shared/getRequestData.js","dependencies":[{"path":"/Users/wuxingliu/ylz_work/2020/statistics/src/shared/getRequestData.js","mtime":1598151266000},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/cache-loader/dist/cjs.js","mtime":1598022527352},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/babel-loader/lib/index.js","mtime":1597741073441},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/eslint-loader/index.js","mtime":1598022528243}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy93dXhpbmdsaXUveWx6X3dvcmsvMjAyMC9zdGF0aXN0aWNzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKZXhwb3J0IGZ1bmN0aW9uIGdldFJlcXVlc3REYXRhKHJlcXVlc3QpIHsKICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7CiAgICBjYWNoZTogZmFsc2UKICB9OwogIHZhciBjYWNoZSA9IGNvbmZpZy5jYWNoZTsKICB2YXIgY2FjaGVkUGF5bG9hZCA9IG51bGw7CiAgcmV0dXJuIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3BhcnNlZCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIF9sZW4sCiAgICAgICAgICBhcmdzLAogICAgICAgICAgX2tleSwKICAgICAgICAgIHJlcywKICAgICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghKGNhY2hlICYmIGNhY2hlZFBheWxvYWQpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgY2FjaGVkUGF5bG9hZCk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CgogICAgICAgICAgICAgIGZvciAoX2xlbiA9IF9hcmdzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICAgICAgICAgIGFyZ3NbX2tleV0gPSBfYXJnc1tfa2V5XTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmFwcGx5KHRoaXMsIGFyZ3MpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIGlmICghKHJlcyAmJiByZXMuZGF0YSAmJiByZXMuZGF0YS5zdGF0dXMgPT09IDIwMCAmJiByZXMuZGF0YS5wYXlsb2FkKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYWNoZWRQYXlsb2FkID0gcmVzLmRhdGEucGF5bG9hZDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXMuZGF0YS5wYXlsb2FkKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIlx1OEJGN1x1NkM0MiAiLmNvbmNhdChyZXF1ZXN0Lm5hbWUsICIgXHU1MUZBXHU5NTE5XHVGRjBDXHU5NTE5XHU4QkVGXHU3ODAxXHVGRjFBIiksIHJlcy5kYXRhLnN0YXR1cyB8fCAn5pyq55+l6ZSZ6K+v56CBJyk7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE2OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coInJlcXVlc3QtIi5jb25jYXQocmVxdWVzdC5uYW1lLCAiXHU1MUZBXHU5NTE5OiIpLCBfY29udGV4dC50MCk7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzIsIDE2XV0pOwogICAgfSkpOwoKICAgIGZ1bmN0aW9uIHBhcnNlZCgpIHsKICAgICAgcmV0dXJuIF9wYXJzZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICByZXR1cm4gcGFyc2VkOwogIH0oKTsKfQ=="},{"version":3,"sources":["/Users/wuxingliu/ylz_work/2020/statistics/src/shared/getRequestData.js"],"names":["getRequestData","request","config","cache","cachedPayload","args","apply","res","data","status","payload","console","log","name","parsed"],"mappings":";;;AAAA,OAAO,SAASA,cAAT,CAAwBC,OAAxB,EAA4D;AAAA,MAA3BC,MAA2B,uEAAlB;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAAkB;AAAA,MAC3DA,KAD2D,GACjDD,MADiD,CAC3DC,KAD2D;AAEjE,MAAIC,aAAa,GAAG,IAApB;AAEA;AAAA,0EAAO;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACDD,KAAK,IAAIC,aADR;AAAA;AAAA;AAAA;;AAAA,+CAEIA,aAFJ;;AAAA;AAAA;;AAAA,wCAAyBC,IAAzB;AAAyBA,gBAAAA,IAAzB;AAAA;;AAAA;AAAA,qBAKeJ,OAAO,CAACK,KAAR,CAAc,IAAd,EAAoBD,IAApB,CALf;;AAAA;AAKGE,cAAAA,GALH;;AAAA,oBAMCA,GAAG,IAAIA,GAAG,CAACC,IAAX,IAAmBD,GAAG,CAACC,IAAJ,CAASC,MAAT,KAAoB,GAAvC,IAA8CF,GAAG,CAACC,IAAJ,CAASE,OANxD;AAAA;AAAA;AAAA;;AAODN,cAAAA,aAAa,GAAGG,GAAG,CAACC,IAAJ,CAASE,OAAzB;AAPC,+CAQMH,GAAG,CAACC,IAAJ,CAASE,OARf;;AAAA;AAUDC,cAAAA,OAAO,CAACC,GAAR,wBAAkBX,OAAO,CAACY,IAA1B,kDAA0CN,GAAG,CAACC,IAAJ,CAASC,MAAT,IAAmB,OAA7D;AAVC,+CAWM,IAXN;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAcHE,cAAAA,OAAO,CAACC,GAAR,mBAAuBX,OAAO,CAACY,IAA/B;;AAdG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA,aAAsBC,MAAtB;AAAA;AAAA;;AAAA,WAAsBA,MAAtB;AAAA;AAiBD","sourcesContent":["export function getRequestData(request, config = { cache: false }) {\n  let { cache } = config\n  let cachedPayload = null\n\n  return async function parsed(...args) {\n    if (cache && cachedPayload) {\n      return cachedPayload\n    }\n    try {\n      const res = await request.apply(this, args)\n      if (res && res.data && res.data.status === 200 && res.data.payload) {\n        cachedPayload = res.data.payload\n        return res.data.payload\n      } else {\n        console.log(`请求 ${request.name} 出错，错误码：`, res.data.status || '未知错误码')\n        return null\n      }\n    } catch (error) {\n      console.log(`request-${request.name}出错:`, error)\n    }\n  }\n}\n"]}]}