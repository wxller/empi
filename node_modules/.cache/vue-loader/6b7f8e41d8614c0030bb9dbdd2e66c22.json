{"remainingRequest":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wuxingliu/ylz_work/2020/statistics/src/components/Interaction.vue?vue&type=style&index=0&id=998e99dc&scoped=true&lang=scss&","dependencies":[{"path":"/Users/wuxingliu/ylz_work/2020/statistics/src/components/Interaction.vue","mtime":1598154038000},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/css-loader/dist/cjs.js","mtime":1597766290974},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1598022528944},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/postcss-loader/src/index.js","mtime":1598022528922},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/sass-loader/dist/cjs.js","mtime":1598144232417},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/cache-loader/dist/cjs.js","mtime":1598022527352},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/vue-loader/lib/index.js","mtime":1598022528944}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudGFibGUtd3JhcHBlciB7CiAgbWFyZ2luLXRvcDogMTBweDsKICAudG9vbC1zaWZ0IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwogICAgbWFyZ2luOiAxMHB4IDA7CiAgfQp9Cg=="},{"version":3,"sources":["Interaction.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Interaction.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"table-wrapper\">\n    <section class=\"tool-sift\">\n      <a-month-picker placeholder=\"选择年月\" v-model=\"date\" @change=\"getInteractionTable\" />\n    </section>\n    <a-table\n      :scroll=\"{ y: '30vh' }\"\n      :columns=\"columns\"\n      :data-source=\"tableData\"\n      :pagination=\"false\"\n      :rowKey=\"genRowKey\"\n    >\n      <span slot=\"serviceName\" slot-scope=\"text\">{{ text }}</span>\n      <span slot=\"total\"></span>\n      <span slot=\"upstream\"></span>\n      <span slot=\"downstream\"></span>\n      <span slot=\"action\">\n        <a>查看日志</a>\n      </span>\n    </a-table>\n    <InterActionLineChart :data=\"lineData\" />\n  </div>\n</template>\n\n<script>\nimport { INTERACTION_COLUMNS } from '../shared/dataColumns'\nimport { parseLineData } from '../shared/parseLineData'\nimport InterActionLineChart from './InterActionLineChart'\nimport moment from 'moment'\nimport { fetchInteractionTable, fetchInteractionLineData } from '../api/interactionApi'\nimport { getRequestData } from '../shared/getRequestData'\n\nexport default {\n  name: 'Interaction',\n  components: {\n    InterActionLineChart, \n  },\n  mounted() {\n    this.getInteractionTable()\n    this.getInteractionLineData()\n  },\n  data() {\n    return {\n      date: moment(),\n      columns: INTERACTION_COLUMNS,\n      tableData: [],\n      lineData: [],\n    }\n  },\n  methods: {\n    async getInteractionTable(date) {\n      let year\n      let month\n      if (date == null) {\n        year = moment().year()\n        month = moment().month() + 1\n      } else {\n        year = date.year()\n        month = date.month() + 1\n      }\n\n      const res = await getRequestData(fetchInteractionTable)({ year, month })\n      console.log(res);\n      this.tableData = res\n    },\n    async getInteractionLineData() {\n      const res = await getRequestData(fetchInteractionLineData)()\n      this.lineData = parseLineData(res, 'sumTotal')\n    },\n    genRowKey(record) {\n      return `${record.serviceName}-${record.countYear}-${record.countMonth}`\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.table-wrapper {\n  margin-top: 10px;\n  .tool-sift {\n    display: flex;\n    justify-content: flex-end;\n    margin: 10px 0;\n  }\n}\n</style>\n"]}]}