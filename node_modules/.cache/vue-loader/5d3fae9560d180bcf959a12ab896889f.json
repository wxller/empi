{"remainingRequest":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wuxingliu/ylz_work/2020/statistics/src/components/Interaction.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wuxingliu/ylz_work/2020/statistics/src/components/Interaction.vue","mtime":1598106454000},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/babel-loader/lib/index.js","mtime":1597741073441},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/cache-loader/dist/cjs.js","mtime":1598022527352},{"path":"/Users/wuxingliu/ylz_work/2020/statistics/node_modules/vue-loader/lib/index.js","mtime":1598022528944}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IElOVEVSQUNUSU9OX0NPTFVNTlMgfSBmcm9tICcuLi9zaGFyZWQvZGF0YUNvbHVtbnMnCmltcG9ydCB7IHBhcnNlTGluZURhdGEgfSBmcm9tICcuLi9zaGFyZWQvcGFyc2VMaW5lRGF0YScKaW1wb3J0IEludGVyQWN0aW9uTGluZUNoYXJ0IGZyb20gJy4vSW50ZXJBY3Rpb25MaW5lQ2hhcnQnCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JwppbXBvcnQgeyBmZXRjaEludGVyYWN0aW9uVGFibGUsIGZldGNoSW50ZXJhY3Rpb25MaW5lRGF0YSB9IGZyb20gJy4uL2FwaS9pbnRlcmFjdGlvbkFwaScKaW1wb3J0IHsgZ2V0UmVxdWVzdERhdGEgfSBmcm9tICcuLi9zaGFyZWQvZ2V0UmVxdWVzdERhdGEnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0ludGVyYWN0aW9uJywKICBjb21wb25lbnRzOiB7CiAgICBJbnRlckFjdGlvbkxpbmVDaGFydCwKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldEludGVyYWN0aW9uVGFibGUoKQogICAgdGhpcy5nZXRJbnRlcmFjdGlvbkxpbmVEYXRhKCkKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRlOiBtb21lbnQoKSwKICAgICAgY29sdW1uczogSU5URVJBQ1RJT05fQ09MVU1OUywKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgbGluZURhdGE6IFtdLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0SW50ZXJhY3Rpb25UYWJsZShkYXRlKSB7CiAgICAgIGxldCB5ZWFyCiAgICAgIGxldCBtb250aAogICAgICBpZiAoZGF0ZSA9PSBudWxsKSB7CiAgICAgICAgeWVhciA9IG1vbWVudCgpLnllYXIoKQogICAgICAgIG1vbnRoID0gbW9tZW50KCkubW9udGgoKSArIDEKICAgICAgfSBlbHNlIHsKICAgICAgICB5ZWFyID0gZGF0ZS55ZWFyKCkKICAgICAgICBtb250aCA9IGRhdGUubW9udGgoKSArIDEKICAgICAgfQoKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0UmVxdWVzdERhdGEoZmV0Y2hJbnRlcmFjdGlvblRhYmxlKSh7IHllYXIsIG1vbnRoIH0pCiAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzCiAgICB9LAogICAgYXN5bmMgZ2V0SW50ZXJhY3Rpb25MaW5lRGF0YSgpIHsKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0UmVxdWVzdERhdGEoZmV0Y2hJbnRlcmFjdGlvbkxpbmVEYXRhKSgpCiAgICAgIHRoaXMubGluZURhdGEgPSBwYXJzZUxpbmVEYXRhKHJlcywgJ3N1bVRvdGFsJykKICAgIH0sCiAgICBnZW5Sb3dLZXkocmVjb3JkKSB7CiAgICAgIHJldHVybiBgJHtyZWNvcmQuc2VydmljZU5hbWV9LSR7cmVjb3JkLmNvdW50WWVhcn0tJHtyZWNvcmQuY291bnRNb250aH1gCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["Interaction.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Interaction.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"table-wrapper\">\n    <section class=\"tool-sift\">\n      <a-month-picker placeholder=\"选择年月\" v-model=\"date\" @change=\"getInteractionTable\" />\n    </section>\n    <a-table\n      :scroll=\"{ y: '30vh' }\"\n      :columns=\"columns\"\n      :data-source=\"tableData\"\n      :pagination=\"false\"\n      :rowKey=\"genRowKey\"\n    >\n      <span slot=\"serviceName\" slot-scope=\"text\">{{ text }}</span>\n      <span slot=\"total\"></span>\n      <span slot=\"upstream\"></span>\n      <span slot=\"downstream\"></span>\n      <span slot=\"action\">\n        <a>查看日志</a>\n      </span>\n    </a-table>\n    <InterActionLineChart :data=\"lineData\" />\n  </div>\n</template>\n\n<script>\nimport { INTERACTION_COLUMNS } from '../shared/dataColumns'\nimport { parseLineData } from '../shared/parseLineData'\nimport InterActionLineChart from './InterActionLineChart'\nimport moment from 'moment'\nimport { fetchInteractionTable, fetchInteractionLineData } from '../api/interactionApi'\nimport { getRequestData } from '../shared/getRequestData'\n\nexport default {\n  name: 'Interaction',\n  components: {\n    InterActionLineChart,\n  },\n  mounted() {\n    this.getInteractionTable()\n    this.getInteractionLineData()\n  },\n  data() {\n    return {\n      date: moment(),\n      columns: INTERACTION_COLUMNS,\n      tableData: [],\n      lineData: [],\n    }\n  },\n  methods: {\n    async getInteractionTable(date) {\n      let year\n      let month\n      if (date == null) {\n        year = moment().year()\n        month = moment().month() + 1\n      } else {\n        year = date.year()\n        month = date.month() + 1\n      }\n\n      const res = await getRequestData(fetchInteractionTable)({ year, month })\n      this.tableData = res\n    },\n    async getInteractionLineData() {\n      const res = await getRequestData(fetchInteractionLineData)()\n      this.lineData = parseLineData(res, 'sumTotal')\n    },\n    genRowKey(record) {\n      return `${record.serviceName}-${record.countYear}-${record.countMonth}`\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.table-wrapper {\n  margin-top: 10px;\n  .tool-sift {\n    display: flex;\n    justify-content: flex-end;\n    margin: 10px 0;\n  }\n}\n</style>\n"]}]}